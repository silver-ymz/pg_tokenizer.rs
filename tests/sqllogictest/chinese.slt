statement ok
BEGIN;

statement ok
CREATE TABLE documents (
    id SERIAL PRIMARY KEY,
    passage TEXT,
    embedding INT[]
);

statement ok
SELECT tokenizer_catalog.create_text_analyzer('text_analyzer1', $$
[pre_tokenizer.jieba]
$$);

statement ok
SELECT tokenizer_catalog.create_custom_model_tokenizer_and_trigger(
    tokenizer_name => 'tokenizer1',
    model_name => 'model1',
    text_analyzer_name => 'text_analyzer1',
    table_name => 'documents',
    source_column => 'passage',
    target_column => 'embedding'
);

statement ok
INSERT INTO documents (passage) VALUES 
('红海早过了，船在印度洋面上开驶着，但是太阳依然不饶人地迟落早起，侵占去大部分的夜。'),
('夜仿佛纸浸了油变成半透明体；它给太阳拥抱住了，分不出身来，也许是给太阳陶醉了，所以夕照晚霞褪后的夜色也带着酡红。'),
('到红消醉醒，船舱里的睡人也一身腻汗地醒来，洗了澡赶到甲板上吹海风，又是一天开始。'),
('这是七月下旬，合中国旧历的三伏，一年最热的时候。在中国热得更比常年利害，事后大家都说是兵戈之象，因为这就是民国二十六年【一九三七年】。'),
('这条法国邮船白拉日隆子爵号（VicomtedeBragelonne）正向中国开来。'),
('早晨八点多钟，冲洗过的三等舱甲板湿意未干，但已坐满了人，法国人、德国流亡出来的犹太人、印度人、安南人，不用说还有中国人。'),
('海风里早含着燥热，胖人身体给炎风吹干了，上一层汗结的盐霜，仿佛刚在巴勒斯坦的死海里洗过澡。'),
('毕竟是清晨，人的兴致还没给太阳晒萎，烘懒，说话做事都很起劲。'),
('那几个新派到安南或中国租界当警察的法国人，正围了那年轻善撒娇的犹太女人在调情。'),
('俾斯麦曾说过，法国公使大使的特点，就是一句外国话不会讲；这几位警察并不懂德文，居然传情达意，引得犹太女人格格地笑，比他们的外交官强多了。'),
('这女人的漂亮丈夫，在旁顾而乐之，因为他几天来，香烟、啤酒、柠檬水沾光了不少。'),
('红海已过，不怕热极引火，所以等一会甲板上零星果皮、纸片、瓶塞之外，香烟头定又遍处皆是。'),
('法国人的思想是有名的清楚，他的文章也明白干净，但是他的做事，无不混乱、肮脏、喧哗，但看这船上的乱糟糟。'),
('这船，倚仗人的机巧，载满人的扰攘，寄满人的希望，热闹地行着，每分钟把沾污了人气的一小方小面，还给那无情、无尽、无际的大海。');

query T
SELECT embedding FROM documents ORDER BY id;
----
{22,9,17,12,7,6,27,21,26,1,18,12,25,4,2,23,5,20,16,12,28,11,15,19,3,10,24,8}
{24,47,51,17,48,57,58,55,44,53,56,41,35,42,4,31,33,17,12,32,34,39,54,12,29,36,42,4,60,17,12,37,40,45,38,30,10,52,46,49,18,59,50,8}
{61,50,62,12,65,69,10,73,63,46,67,66,64,81,72,12,78,17,70,76,79,68,75,71,12,74,36,77,80,8}
{110,116,96,12,92,119,121,10,95,12,87,83,10,106,8,6,119,91,82,101,104,84,12,94,111,103,122,36,97,109,12,85,93,113,114,98,105,89,115,88,112,108,117,100,118,102,99,90,86,107,8}
{93,129,134,133,131,126,128,123,127,125,132,124,119,130,8}
{135,148,156,161,12,152,141,10,149,147,79,150,146,153,12,145,139,162,17,63,12,134,159,157,136,144,154,158,10,151,155,136,27,160,136,142,63,12,140,143,163,119,63,8}
{71,69,168,169,18,177,12,172,63,175,42,167,171,17,12,68,170,166,10,180,12,47,165,6,181,178,164,174,10,179,182,176,173,8}
{185,36,186,12,63,10,187,189,190,42,4,192,12,184,12,193,191,103,188,183,8}
{200,206,198,61,142,194,119,204,202,199,10,134,159,157,12,203,17,200,197,207,205,10,151,196,6,195,8}
{209,227,122,141,12,134,224,228,10,218,12,113,231,214,212,225,226,41,93,211,199,229,34,208,217,12,230,215,221,12,219,151,196,216,220,12,101,210,10,222,223,213,17,8}
{93,196,10,243,238,12,6,241,233,237,12,85,239,236,54,12,232,136,242,136,240,234,235,17,244,8}
{22,253,12,249,245,250,12,37,251,255,79,68,247,260,136,256,136,258,259,12,232,246,248,257,74,252,254,36,8}
{134,159,157,10,269,36,261,10,262,12,239,10,266,46,273,265,12,25,239,10,191,12,274,270,136,263,136,267,12,145,271,93,268,10,264,272,8}
{285,12,280,63,10,275,12,283,63,10,284,12,282,63,10,288,12,291,287,18,12,290,279,277,276,17,295,10,292,286,12,293,200,289,136,278,136,294,10,281,8}